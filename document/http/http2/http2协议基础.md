## http2协议基础

| author | update |
| ------ | ------ |
| perrynzhou@gmail.com | 2020/11/03 |

- http2主要解决了http1的性能问题，同时新增了如下新的东西，这些新的功能是不能向前兼容的
  - 二进制协议
  - 多路复用
  - 流量控制功能
  - 数据流优先级
  - 首部压缩
  - 服务端推送

- 二进制协议
  - http1和http2的主要区别之一是http2是一个二进制的、基于数据包的协议，而http1是完全基于文本的协议。使用基于文本的协议，要先发送请求，并接受完响应之后，才开始下一个请求的处理。虽然http1.0引入耳机中南海的http消息体，支持响应中发送图片或者其他媒体文件，http1.1引入管道化和分块编码，分块编码允许先发送消息体的一部分，当其余的部分可用是在接着发送。这是http的消息体被分割成多个块，客户端可以在完整接受到所有数据之前就开始处理这些分块数据的内容(服务端也可以接受分块请求)，这个技术用于数据长度动态生成的场景，预先是不知道数据的总长度。分块编码和管道化都有对头阻塞的问题，在队列首部的消息会阻塞后面消息的发送，同时管道化 在实际应用中并没有得到很多的支持
  - http2变成了二进制的协议，http消息被分成清晰定义的数据帧发送，所有的http2的下消息都被使用分块编码技术，这是标准行为。这里的帧和tcp数据包类似。当收到所有的数据帧后，可以将他们组合为完整的http消息，尽管和tcp有很多相同的地方，但是http2通常还是建立在tcp之上，他没有替换tcp(google已经使用quic替代了tcp)
  - http2中的二进制表示用于发送和接收消息数据，二进制帧通常由下层客户端(WEB服务器或者浏览器)或者第三方库来处理，业务层使用http2和之前http1一样。
